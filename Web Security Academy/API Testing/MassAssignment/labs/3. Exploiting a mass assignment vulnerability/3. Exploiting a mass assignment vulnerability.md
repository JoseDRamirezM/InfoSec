# Recon

The application presents an e-commerce, identify the API endpoints and what they're used for:

![[API Testing/MassAssignment/labs/3. Exploiting a mass assignment vulnerability/images/api-checkout.png]]

It seems that the API functionality is invoked when inspecting and checking out the cart. Inspect the request:

- View cart

![[API Testing/MassAssignment/labs/3. Exploiting a mass assignment vulnerability/images/checkout-get.png]]

- Check out cart

![[API Testing/MassAssignment/labs/3. Exploiting a mass assignment vulnerability/images/checkout-post.png]]

# Vuln assessment

The scenario suggest to `POST` to the cart indicating some parameters obtained form the `GET` request to the API endpoint.

![[post-checkout-zero.png]]

# Exploitation

That parameter didn't work, when loading the cart again the price still applies, now try with `chosen_discount` parameter:

![[free-jacket.png]]

Setting this parameter to obtain 100% discount solves the lab.