# How to find and exploit information disclosure vulnerabilities
#THEORY 
#INFORMATIONDISCLOSURE
<hr>

## How to test for information disclosure vulnerabilities

Avoid developing "tunnel-vision" during testing, sensitive and useful information may appear anywhere within the application. The key skill is to recognize interesting information whenever and wherever you do come across it.

### Techniques
- [[#Fuzzing]]
- [[#Using  Burp Scanner]]
- [[#Using Burp's engagement tools]]
- [[#Engineering informative responses]]

### Fuzzing

The main concept of this is to identify interesting parameters and submitting unexpected data types and crafted "fuzz strings" to see what effect it has.

Look for:
- Response content
- Response time
- What kind of error its triggered

Working with Burp Intruder allows to:

-   Add payload positions to parameters and use pre-built wordlists of fuzz strings to test a high volume of different inputs in quick succession.
-   Easily identify differences in responses by comparing HTTP status codes, response times, lengths, and so on.
-   Use grep matching rules to quickly identify occurrences of keywords, such as `error`, `invalid`, `SELECT`, `SQL`, and so on.
-   Apply grep extraction rules to extract and compare the content of interesting items within responses.

#INTERESTING

Check the `Logger++` extension.

### Using Burp Scanner

[Burp Suite Professional](https://portswigger.net/burp/pro) users have the benefit of Burp Scanner. This provides live scanning features for auditing items while you browse, or you can schedule automated scans to crawl and audit the target site on your behalf. Both approaches will automatically flag many information disclosure vulnerabilities for you. For example, Burp Scanner will alert you if it finds sensitive information such as private keys, email addresses, and credit card numbers in a response. It will also identify any backup files, directory listings, and so on.

### Using Burp's engagement tools

Burp provides several engagement tools that you can use to find interesting information in the target website more easily. You can access the engagement tools from the context menu - just right-click on any HTTP message, Burp Proxy entry, or item in the site map and go to "Engagement tools".

The following tools are particularly useful in this context.

#### Search

You can use this tool to look for any expression within the selected item. You can fine-tune the results using various advanced search options, such as regex search or negative search. This is useful for quickly finding occurrences (or absences) of specific keywords of interest.

#### Find comments

You can use this tool to quickly extract any developer comments found in the selected item. It also provides tabs to instantly access the HTTP request/response cycle in which each comment was found.

#### Discover content

You can use this tool to identify additional content and functionality that is not linked from the website's visible content. This can be useful for finding additional directories and files that won't necessarily appear in the site map automatically.

### Engineering informative responses

Check thoroughly verbose error messages and try to  study the way error messages change based on the provided input.

One common example is to make the application logic attempt an invalid action on a specific item of data. For example, submitting an invalid parameter value might lead to a stack trace or debug response that contains interesting details. You can sometimes cause error messages to disclose the value of your desired data in the response.

## Common sources of information disclosure

Information disclosure can occur in a wide variety of contexts within a website. The following are some common examples of places where you can look to see if sensitive information is exposed.

-   [[#Files for web crawlers]]
-   [[#Directory listings]]
-   [[#Developer comments]]
-   [[#Error messages]]
-   [[#Debugging data]]
-   [[#User account pages]]
-   [[#Source code disclosure via backup files]]
-   [[#Insecure configuration]]
-   [[#Version control history]]

### Files for web crawlers

Many websites provide files at `/robots.txt` and `/sitemap.xml` to help crawlers navigate their site. Among other things, these files often list specific directories that the crawlers should skip, for example, because they may contain sensitive information.

As these files are not usually linked from within the website, they may not immediately appear in Burp's site map. However, it is worth trying to navigate to `/robots.txt` or `/sitemap.xml` manually to see if you find anything of use.

### Directory listings

Web servers can be configured to automatically list the contents of directories that do not have an index page present. This can aid an attacker by enabling them to quickly identify the resources at a given path, and proceed directly to analyzing and attacking those resources. It particularly increases the exposure of sensitive files within the directory that are not intended to be accessible to users, such as temporary files and crash dumps.

Directory listings themselves are not necessarily a security vulnerability. However, if the website also fails to implement proper access control, leaking the existence and location of sensitive resources in this way is clearly an issue.

### Developer comments

During development, in-line HTML comments are sometimes added to the markup. These comments are typically stripped before changes are deployed to the production environment. However, comments can sometimes be forgotten, missed, or even left in deliberately because someone wasn't fully aware of the security implications. Although these comments are not visible on the rendered page, they can easily be accessed using Burp, or even the browser's built-in developer tools.

Occasionally, these comments contain information that is useful to an attacker. For example, they might hint at the existence of hidden directories or provide clues about the application logic.

### Error messages

Are the most common cause of information disclosure. Pay close attention to all error messages. The content of these messages may suggest exploitable parameters e.g. telling their data type and save time with others that won't lead anywhere.

Error messages may also leak information about the technology used by the website e.g

- Template engine
- Database type
- Server

Which allows an attacker to:
- Search for documented exploits
- Detect configuration errors
- Frameworks (open source or not)

Checking subtle differences between error messages is key to use other techniques like [[SQL injection]] or `Username enumeration`.

#### Exploitation example

[[Information disclosure in error messages]]

A summary of the information error messages can leak:
- Exploitable parameters and expected data type
- Used technology information
	- Template engine
	- Database type
	- Server

### Debugging data

Custom error messages that contain information about the application behavior may be deployed in the production environment.

Debug messages can sometimes contain vital information for developing an attack, including:

-   Values for key session variables that can be manipulated via user input
-   Hostnames and credentials for back-end components
-   File and directory names on the server
-   Keys used to encrypt data transmitted via the client

Debugging information may sometimes be logged in a separate file. If an attacker is able to gain access to this file, it can serve as a useful reference for understanding the application's runtime state. It can also provide several clues as to how they can supply crafted input to manipulate the application state and control the information received.

#### Exploitation example
[[Information disclosure on debug page]]

### User account pages
A user's profile page can contain sensitive information such as:

- Email addresses
- Phone numbers
- API key

This isn't a vulnerability by itself, but the application may contain `logic flaws` that may allow an attacker to leverage this pages to see other user's data.

#### Example
For example, consider a website that determines which user's account page to load based on a `user` parameter.

`GET /user/personal-info?user=carlos`

Most websites will perform the necessary validations to avoid exposing information of other users. Although an attacker may not be able to render another user's account entirely, the website may expose some information like other user's email address for example. 

This happens because the application doesn't check that the `user` parameter is the same as the user that is currently logged in, presenting the above scenario. 

### Source code disclosure via backup files

Exposing source code gives an attacker better understanding of the application and helps creating high-severity attacks. Sensitive data like API keys and credentials for backend components are often hard-coded.

In some cases it may be possible to make a website expose its source code via various methods:

- Server file extension handling: trick the server into sending a file as text instead of executing it.
- Backup files: text editors may create temporary backups of files, it may be possible to access them by appending a tilde (`~`) to the filename or using a backup file extension.

#### Exploitation example

[[Source code disclosure via backup files]]

### Insecure configuration

Improper configuration of an application may make it vulnerable, this is common when using widespread of third-party technologies, which have a lot of configuration options that may not be well understood by the developers.

It's also important to disable debugging options in productive environments. For example the `TRACE` method is specially dangerous as it may lead to information disclosure of authentication headers that reverse proxies append and also [Cross Site Tracing](https://owasp.org/www-community/attacks/Cross_Site_Tracing)

#### Exploitation example

[[Authentication bypass via information disclosure]]

### Version control history

Websites are developed using some kind of version control such as Git, which stores all the version control data in the `.git` directory which is sometimes exposed in production environments.

This directory may leak snippets of the source code and hard-coded sensitive information.

#### Exploitation example







