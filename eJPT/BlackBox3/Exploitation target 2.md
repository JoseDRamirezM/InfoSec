# Exploitation target 2

The credentials of the mysql service were found after exploiting **target 1** [[Exploitation target 1]] 

![[target_1_mysql_creds.png]]

The credentials worked.

![[target_2_mysql_access.png]]

I tried to get information from the `mysql` database.

![[target_2_tables.png]]

All the tables except `user` are empty. Read the content of the table.

```sql
SELECT * FROM user;
```

![[target_2_user_table.png]]

Select only the interesting columns.

```sql
SELECT Host,User,Password FROM user;
```

![[target_2_user_table_better.png]]

The table contains some passwords.

# Leverage the mysql connection

Use the `exploit/multi/mysql/mysql_udf_payload`  to be able to execute commands on the compromised hosts.

## Module configuration

![[target_2_udf_options.png]]

- Force UDF UPLOAD : Set to true in order to execute commands via the sys_exec() mysql function.
- RHOSTS: IP address of the target.
- RPORT: Port of the mysql service on the target.
- USERNAME: mysql login username (root).
- PASSWORD: mysql login password (password).

Also configure the **Exploit target** to **Linux** by running:

`set TARGET 1`

Configure the options accordingly and run the exploit.

**CAREFUL**  remove the `-p` argument from the password.

![[target_2_mysql_udf_exploit.png]]

The exploit creates a Meterpreter session as the root user. Interact with the session.

![[target_2_flag.png]]
 





