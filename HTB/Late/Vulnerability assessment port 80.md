# Vulnerability assessment port 80

# Testing the index page

With the information from [[Footprinting and port scanning]] test the web server.

## Web attack methodology

### Vulnerable version of service

I found no known exploits for `nginx 1.14.0`

![[knownExploits.png]]

### Web server fingerprinting

Not much more was found.

![[webServerFingerprint.png]]

![[webServerFingerprint_1.png]]

### Directory and file enumeration

![[dirs.png]]

### Page inspection

The index page provides a domain, which increases the attack surface

![[imagesDomain.png]]

Add it to `/etc/hosts` and test it as there doesn't seem to be much more in the index.

# images.late.htb domain

As the service is in the same server I skipped to inspecting the service.

![[imagesService.png]]

I tested the functionality by providing a sample image.

![[imagesServiceFunctionality.png]]

It works as it says. Next I investigated further.

![[error.png]]

I tried to upload various malicious files but it didn't work.

The page exposes that the framework used for the app is `Flask`, next searching for common vulnerabilities in this framework, the Server Side Template Injection [SSTI](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/18-Testing_for_Server_Side_Template_Injection) vulnerability is often exploited. Then as the app renders the image's text as a HTML template, test if it is possible to inject python code within the image's text and if it is interpreted as so.

## Test image
![[SSTI_test_image.png]]

Next provide the image as input and check the result.

![[SSTI_confirmed.png]]


[[Exploitation SSTI]]
