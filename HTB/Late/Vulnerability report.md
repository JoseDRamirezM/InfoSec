# Vulnerability report

# Information disclosure of web Service

## Severity

5.1 Medium

## Description

The `images.late` domain exposes information about the technology that is used for the application in this case `Flask`.

## Impacts

- Obtain valuable information to craft new attacks.
- Expand the attack surface.

## Mitigation
Remove the `Flask` word from the service's index page.

More information [here](https://portswigger.net/web-security/information-disclosure)

## Evidence and/or POC

[[Vulnerability assessment port 80]]

# Server Side Template Injection

## Severity

9.3 Critical

## Description

User input is used to generate HTML responses and is embedded in a template insecurely allowing an attacker to inject arbitrary code to the server. 

## Specifics

in this case the OCR tool was used to extract the text from an user controlled image, which result was rendered into an HTML document. Knowing that `Flask` uses the `Jinja` template engine, it was easy to know the correct attack payload.

## Impacts

- Evaluate malicious payloads in the server.
- [[#Command Injection]]
- Expand the attack surface.

## Mitigation
Sanitize user input before providing it to the template engine.

More information [here](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/18-Testing_for_Server_Side_Template_Injection) and [here](https://portswigger.net/web-security/server-side-template-injection)

## POC

[[Exploitation SSTI]]


# Command Injection

## Severity

10 Critical

## Description

A server side template injection vulnerability allows an attacker to inject OS commands with crafted images containing malicious payloads. 

## Impacts

- Execute arbitrary commands on the server
- Expand the attack surface.

## Mitigation
Sanitize user input before providing it to the template engine.

More information [here](https://owasp.org/www-community/attacks/Command_Injection)

## POC

[[Exploitation SSTI]]

# Privilege escalation

## Severity

10 Critical

## Description

The root user executes an user defined script, also the  `PATH` environment variable points to a user controlled directory hence giving an attacker control over the script. Finally injecting malicious payload in the script allows to obtain a `root` user shell.

## Impacts

- Escalate privileges to the root system user.
- Expand the attack surface.

## Mitigation
Revoke permissions to the system user over the script and modify the `PATH` environment variable to point to secure directories.

## POC

[[Privilege escalation]]
