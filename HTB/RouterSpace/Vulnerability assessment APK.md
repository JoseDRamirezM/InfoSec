# Vulnerability assessment APK

I downloaded the `.apk` file and now I got to emulate it. First I tried on Android Studio but I wasn't able to configure it properly in order for it to work.

Then I looked for alternatives and found  `anbox` that is an Android Emulator available on Linux. Installing this tool was complicated, there's a lot of ways to install it and some of them may not work. In the end I managed to make it run.

Run

```shell
sudo snap install --devmode --beta anbox
```

Then wait for it to finish. On the system's application list the `Anbox Application Manager` app should appear. Run it. 

![[anbox_app_mngr.png]]

Next install the `Router Space` app using `adb`.

Run

```shell
sudo apt install android-tools-adb
```

And then

```shell
adb install RouterSpace.apk 
```

The app should appear on the application manager.

![[app_mngr.png]]

When the app is executed it will not work because one more step is needed for the networking to work. Add a proxy listener on `Burp Suite` as follows.

![[burp_listener.png]]

Next make the emulator use the proxy like so:

```shell
adb shell settings put global http_proxy 10.10.14.175:8888
```

Put the IP address given by the VPN connection to the HTB network (usually on the `tun0` interface) and the port set on the proxy listener.

Now run the app again and the request made by pressing the `Check Status` button should be intercepted with a success message from the app.


![[app.png]]

![[request.png]]

![[success.png]]

Now let's test the `ip` POST parameter.

The api seem to just return the value of the `ip` parameter i.e any string passed will be returned (even if it is empty).

![[api_function.png]]

So the first thing I tested was a `lack of data validation` of the field that lead me to a vulnerability. So I tried special characters with test strings and see the api response.

Then I discovered a `Command injection vulnerability`. Appending the `;` character to the field and the `id` command.

![[RCE.png]]

Now exploit the vulnerability to gain a reverse shell.

[[Exploitation APK]]






