# Vulnerability report

## Server side template injection

#### Severity

5.8 Medium

#### Description

The web application search functionality is vulnerable, as it is possible to inject expressions that are evaluated server side with the search bar as entry point.

#### Impacts

- Evaluate malicious payloads in the server.
- [[#Remote Code Execution]]
- Expand the attack surface.

#### Mitigation
Implement input validation using a whitelist approach to avoid unexpected characters rendering in the page.

Sanitize user input before providing it to the template engine.

More information [here](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/18-Testing_for_Server_Side_Template_Injection) and [here](https://portswigger.net/web-security/server-side-template-injection)


#### Evidence and/or POC

[[Exploitation SSTI port 8080]]

## Remote Code Execution

#### Severity

10 Critical

#### Description

A server side template injection vulnerability allows an attacker to inject Java code within a search parameter, that then is processed in the server ultimately leading to OS command injection. 

#### Impacts

- Execute arbitrary commands on the server
- Expand the attack surface.

#### Mitigation

Implement input validation using a whitelist approach to avoid unexpected characters rendering in the page.

Sanitize user input before providing it to the template engine.

More information [here](https://owasp.org/www-community/attacks/Command_Injection)


#### Evidence and/or POC

[[Exploitation RCE port 8080]]

## XML External Entity injection

This vulnerability us the result of other vulnerabilities present in the Web application like:

- Log injection
- Lack of data validation - special characters

#### Severity

10 Critical

#### Description

A malicious XML file can be created which, chained with other vulnerabilities, once the root user executes the `credit_score` application it parses arbitrary files in the server.

#### Impacts

- Retrieve arbitrary files from the server
- Expand the attack surface.

#### Mitigation

Implement input validation using a whitelist approach to avoid unexpected characters rendering in the page.

Sanitize user input before providing it to the template engine.

More information [here](https://owasp.org/www-community/attacks/Command_Injection)


#### Evidence and/or POC

[[Exploitation XXE linux system]]

## Privilege escalation

#### Severity

10 Critical

#### Description

The [[#XML External Entity injection]] vulnerability allows an attacker to escalate privileges as the root user of the server machine by retrieving the user's private SSH key.

#### Impacts

- Gain full control over the server machine.
- Expand the attack surface.

#### Mitigation

Implement input validation using a whitelist approach to avoid unexpected characters rendering in the page.

Sanitize user input before providing it to the template engine.

All the above mitigate the server Linux OS vulnerabilities.

More information [here](https://owasp.org/www-community/attacks/Command_Injection)


#### Evidence and/or POC

[[Exploitation XXE linux system]]