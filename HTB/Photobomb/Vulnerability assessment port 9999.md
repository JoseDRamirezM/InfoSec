This port exposes a Python web server (SimpleHTTPServer 0.6 (Python 3.8.10)) which seems interesting.

## Manual web server testing

I went to `http://photobomb:9999` and some of the server files were available.

![[port9999_server_files.png]]

From the information obtained in [[Vulnerability assessment port 80]] I know the file `server.rb` is the backend controller for the photobomb app, hence the source code alongside other important files are leaked without any authentication mechanism.

## Source code review

Looking a the backend controller code, there's a clear **command injection** vulnerability in how the application generates the desired image for the user. One of the parameters from the request to "print" an image is not correctly sanitized from user input and is appended to a string that finally executes an operating system command.

### PoC

Let's take a look to the vulnerable portion of the code.

![[port80_command_injection.png]]

Bypassing the validation is easy as shown below.

![[port80_bypass_poc.png]]

With that in mind pass an OS command (Linux) to the request. In this case I pinged my IP address and check the traffic with Wireshark.

![[port80_CI_ping_test.png]]

![[port80_ping_success.png]]

The source address is the target machine.

[[Exploitation Command Injection port 80]]





