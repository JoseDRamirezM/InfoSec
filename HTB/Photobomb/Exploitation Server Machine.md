## Linux server enumeration

### sudo -l

Running the `sudo -l` command I noticed something strange.

![[server_sudo_l.png]]

The `SETENV` option is available, then I tried to look for ways to escalate privileges with this. I found information about it [here](https://book.hacktricks.xyz/linux-hardening/privilege-escalation#setenv)

![[server_PE_vector.png]]

Now I got to figure out how to materialize the vector.

Looking at the `cleanup.sh` script, the PE vector I considered is a PATH hijacking or manipulation.

![[server_sudo_l.png]]

![[server_PE_script.png]]

Because the `find` command is not properly invoked i.e `/bin/find`, the idea is to set the PATH environment variable to a user controlled location with and evil copy of the `find` command.

![[server_evil_find.png]]

To execute the payload run this command:

![[server_exploit.png]]

The root shell is received in the listener, retrieve the root flag.