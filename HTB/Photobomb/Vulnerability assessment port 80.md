## Web server attack

### Fingerprint

![[port80_server_fingerprint.png]]

Look if the `nginx` version is vulnerable.

Some CVEs are found

- [CVE-2021-23017](https://www.rapid7.com/db/vulnerabilities/redhat_linux-cve-2021-23017/)
- [CVE-2020-12440](https://vuldb.com/?source_cve.155282)

But nothing concerning for the box.


## Directories and files enumeration

I ran a dirsearch scan


## Manual web application testing

Reviewing the index page source code I checked the `/photobomb.js`  file and found a hidden endpoint apparently with a way to bypass authentication.

![[port80_index_source.png]]

![[port80_auth_script.png]]

Apparently the app uses `Basic` authentication to redirect to the `/printer` endpoint with a provided user.

Inspect the new enpoint

![[port80_printer.png]]

The web application seems to serve image files to users to download them.

The requests that retrieves the images is as follows:

![[port80_retrieve_image_request.png]]

Then I tried testing the request parameters for vulnerabilities.

With the following request the server exposes the stacktrace of an error and a line od source code.

![[port80_tech_leak_stacktrace.png]]

![[port80_stacktrace.png]]

Also by requesting for non-existent paths in the server will expose the backend framework (Sinatra ruby).

![[port80_sinatra.png]]





